SET COMMON_JS_LIBRARY_PATH TO $'''CoinScraper.Common.js'''
SET MainContainerUIElementPath TO $'''html>body>div:eq(1)>div>div>div>div:eq(2)>div>div>div:eq(2)>div:eq(2)>div>div>div>div>div>div:eq(1)>div>div'''
File.ReadText File: COMMON_JS_LIBRARY_PATH Encoding: File.TextFileEncoding.DefaultEncoding Content=> CommonJsFileContents
# Start of autogenerated actions using the web recorder
WebAutomation.LaunchFirefox Url: $'''https://www.coinbase.com/price''' WindowState: WebAutomation.BrowserWindowState.Normal ClearCache: False ClearCookies: False BrowserInstance=> Browser
DISABLE WebAutomation.DataExtraction.GetDetailsOfElement BrowserInstance: Browser Control: appmask['Recording']['div 2'] AttributeName: $'''Own Text''' AttributeValue=> PriceTable
WebAutomation.DataExtraction.ExtractHtmlTable BrowserInstance: Browser Control: $'''table[class^=\'AssetTable\']''' ExtractionParameters: {['#', 'Name', 'Price', 'Change', 'Market cap', 'Trade', 'Watch'], ['', '', '', '', '', '', ''] } ExtractedData=> DataFromWebPage
WebAutomation.DataExtraction.ExtractHtmlTable BrowserInstance: Browser Control: $'''div[class^=\'AssetTable\'] > table''' ExtractionParameters: {['#', 'Name', 'Price', 'Change', 'Market cap', 'Trade', 'Watch'], ['', '', '', '', '', '', ''] } ExtractedData=> DataFromWebPage
WebAutomation.ExecuteJavascript BrowserInstance: Browser Javascript: $'''function ExecuteScript() { 
%CommonJsFileContents%;
return CoinScraper.Common.GetCoinbasePrices();
 }''' Result=> Result
WebAutomation.GoToWebPage BrowserInstance: Browser Url: $'''https://www.coindesk.com/price/dogecoin'''
WebAutomation.ExecuteJavascript BrowserInstance: Browser Javascript: $'''function ExecuteScript() { 
return document.querySelector(\"div[class=\'price-large\']\").textContent.substring(1);
 }''' Result=> DogeResult
Text.Replace Text: Result TextToFind: $''']''' IsRegEx: False IgnoreCase: True ReplaceWith: $''',\"%DogeResult%\" ]''' ActivateEscapeSequences: False Result=> FinalPrices
Variables.ConvertJsonToCustomObject Json: FinalPrices CustomObject=> JsonAsCustomObject
Excel.LaunchAndOpen Path: $'''Crypto Test.xlsx''' Visible: True ReadOnly: False LoadAddInsAndMacros: False Instance=> ExcelInstance
Excel.Advanced.GetFirstFreeRowOnColumn Instance: ExcelInstance Column: $'''A''' FirstFreeRowOnColumn=> FirstFreeRowOnColumn
DateTime.Local DateTimeFormat: DateTime.DateTimeFormat.DateAndTime CurrentDateTime=> CurrentDateTime
Excel.WriteCell Instance: ExcelInstance Value: CurrentDateTime Column: $'''A''' Row: FirstFreeRowOnColumn
SET LoopCounter TO 2
LOOP FOREACH CurrentItem IN JsonAsCustomObject
    Excel.WriteCell Instance: ExcelInstance Value: CurrentItem Column: LoopCounter Row: FirstFreeRowOnColumn
    Variables.IncreaseVariable Value: LoopCounter IncrementValue: 1 IncreasedValue=> LoopCounter
END
Excel.CloseAndSave Instance: ExcelInstance
WebAutomation.CloseWebBrowser BrowserInstance: Browser